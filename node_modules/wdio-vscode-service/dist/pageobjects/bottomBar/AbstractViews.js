import { ElementWithContextMenu } from '../utils.js';
/**
 * View with channel selector/**
 *
 * @category BottomBar
 */
export class ChannelView extends ElementWithContextMenu {
    /**
    * Get names of all selectable channels
    * @returns Promise resolving to array of strings - channel names
    */
    async getChannelNames() {
        // stabilize view otherwise we might run into stale element issues
        // eslint-disable-next-line wdio/no-pause
        await browser.pause(500);
        const select = await this.parent.$(this.locatorMap.BottomBarViews.outputChannels);
        await select.click();
        // stabilize view otherwise we might run into stale element issues
        // eslint-disable-next-line wdio/no-pause
        await browser.pause(500);
        const channels = await this.parent.$$(`${this.locatorMap.BottomBarViews.outputChannels} option`);
        const names = [];
        for (const channel of channels) {
            names.push(await channel.getAttribute('value'));
        }
        return names;
    }
    /**
     * Get name of the current channel
     * @returns Promise resolving to the current channel name
     */
    async getCurrentChannel() {
        const combo = await this.parent.$(this.locatorMap.BottomBarViews.channelCombo);
        return combo.getValue();
    }
    /**
     * Select a channel using the selector combo
     * @param name name of the channel to open
     */
    async selectChannel(name) {
        const select = await this.parent.$(this.locatorMap.BottomBarViews.outputChannels);
        await select.click();
        const channels = await this.parent.$$(`${this.locatorMap.BottomBarViews.outputChannels} option`);
        for (const channel of channels) {
            const val = await channel.getValue();
            if (val === name) {
                await channel.click();
                // eslint-disable-next-line wdio/no-pause
                await browser.pause(200);
                await browser.keys(['Escape']);
                return;
            }
        }
        throw new Error(`Channel ${name} not found`);
    }
}
/**
 * View with channel selection and text area
 */
export class TextView extends ChannelView {
    /**
     * Get all text from the currently open channel
     * @returns Promise resolving to the view's text
     */
    async getText() {
        const lines = await this.elem.$(this.locatorMap.OutputView.lines);
        const textLines = await browser.execute((elem) => Array.from(elem.children).map((l) => l.innerText), lines);
        return textLines
            // strip empty lines (usually the last one)
            .filter(Boolean)
            // replace `\u00A0` characters with white space
            // eslint-disable-next-line no-control-regex
            .map((l) => l.replace(/\u00A0/g, ' '));
    }
    /**
     * Clear the text in the current channel
     * @returns Promise resolving when the clear text button is pressed
     */
    async clearText() {
        await this.parent
            .$(this.locatorMap.BottomBarViews.actionsContainer(this.actionsLabel))
            .$(this.locatorMap.BottomBarViews.clearText)
            .click();
    }
}
//# sourceMappingURL=data:application/json;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiQWJzdHJhY3RWaWV3cy5qcyIsInNvdXJjZVJvb3QiOiIiLCJzb3VyY2VzIjpbIi4uLy4uLy4uL3NyYy9wYWdlb2JqZWN0cy9ib3R0b21CYXIvQWJzdHJhY3RWaWV3cy50cyJdLCJuYW1lcyI6W10sIm1hcHBpbmdzIjoiQUFBQSxPQUFPLEVBQUUsc0JBQXNCLEVBQUUsTUFBTSxhQUFhLENBQUE7QUFFcEQ7Ozs7R0FJRztBQUNILE1BQU0sT0FBZ0IsV0FBZSxTQUFRLHNCQUF5QjtJQUdsRTs7O01BR0U7SUFDRixLQUFLLENBQUMsZUFBZTtRQUNqQixrRUFBa0U7UUFDbEUseUNBQXlDO1FBQ3pDLE1BQU0sT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUN4QixNQUFNLE1BQU0sR0FBRyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLGNBQXdCLENBQUMsQ0FBQTtRQUMzRixNQUFNLE1BQU0sQ0FBQyxLQUFLLEVBQUUsQ0FBQTtRQUVwQixrRUFBa0U7UUFDbEUseUNBQXlDO1FBQ3pDLE1BQU0sT0FBTyxDQUFDLEtBQUssQ0FBQyxHQUFHLENBQUMsQ0FBQTtRQUN4QixNQUFNLFFBQVEsR0FBRyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsRUFBRSxDQUFDLEdBQUcsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsY0FBYyxTQUFTLENBQUMsQ0FBQTtRQUVoRyxNQUFNLEtBQUssR0FBRyxFQUFFLENBQUE7UUFDaEIsS0FBSyxNQUFNLE9BQU8sSUFBSSxRQUFRLEVBQUUsQ0FBQztZQUM3QixLQUFLLENBQUMsSUFBSSxDQUFDLE1BQU0sT0FBTyxDQUFDLFlBQVksQ0FBQyxPQUFPLENBQUMsQ0FBQyxDQUFBO1FBQ25ELENBQUM7UUFDRCxPQUFPLEtBQUssQ0FBQTtJQUNoQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLGlCQUFpQjtRQUNuQixNQUFNLEtBQUssR0FBRyxNQUFNLElBQUksQ0FBQyxNQUFNLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsY0FBYyxDQUFDLFlBQXNCLENBQUMsQ0FBQTtRQUN4RixPQUFPLEtBQUssQ0FBQyxRQUFRLEVBQUUsQ0FBQTtJQUMzQixDQUFDO0lBRUQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLGFBQWEsQ0FBRSxJQUFZO1FBQzdCLE1BQU0sTUFBTSxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxDQUFDLENBQUMsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsY0FBd0IsQ0FBQyxDQUFBO1FBQzNGLE1BQU0sTUFBTSxDQUFDLEtBQUssRUFBRSxDQUFBO1FBQ3BCLE1BQU0sUUFBUSxHQUFHLE1BQU0sSUFBSSxDQUFDLE1BQU0sQ0FBQyxFQUFFLENBQUMsR0FBRyxJQUFJLENBQUMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxjQUFjLFNBQVMsQ0FBQyxDQUFBO1FBQ2hHLEtBQUssTUFBTSxPQUFPLElBQUksUUFBUSxFQUFFLENBQUM7WUFDN0IsTUFBTSxHQUFHLEdBQUcsTUFBTSxPQUFPLENBQUMsUUFBUSxFQUFFLENBQUE7WUFDcEMsSUFBSSxHQUFHLEtBQUssSUFBSSxFQUFFLENBQUM7Z0JBQ2YsTUFBTSxPQUFPLENBQUMsS0FBSyxFQUFFLENBQUE7Z0JBQ3JCLHlDQUF5QztnQkFDekMsTUFBTSxPQUFPLENBQUMsS0FBSyxDQUFDLEdBQUcsQ0FBQyxDQUFBO2dCQUN4QixNQUFNLE9BQU8sQ0FBQyxJQUFJLENBQUMsQ0FBQyxRQUFRLENBQUMsQ0FBQyxDQUFBO2dCQUM5QixPQUFNO1lBQ1YsQ0FBQztRQUNMLENBQUM7UUFDRCxNQUFNLElBQUksS0FBSyxDQUFDLFdBQVcsSUFBSSxZQUFZLENBQUMsQ0FBQTtJQUNoRCxDQUFDO0NBQ0o7QUFFRDs7R0FFRztBQUNILE1BQU0sT0FBZ0IsUUFBWSxTQUFRLFdBQWM7SUFHcEQ7OztPQUdHO0lBQ0gsS0FBSyxDQUFDLE9BQU87UUFDVCxNQUFNLEtBQUssR0FBRyxNQUFNLElBQUksQ0FBQyxJQUFJLENBQUMsQ0FBQyxDQUFDLElBQUksQ0FBQyxVQUFVLENBQUMsVUFBVSxDQUFDLEtBQWUsQ0FBQyxDQUFBO1FBQzNFLE1BQU0sU0FBUyxHQUFHLE1BQU0sT0FBTyxDQUFDLE9BQU8sQ0FDbkMsQ0FBQyxJQUFJLEVBQUUsRUFBRSxDQUFDLEtBQUssQ0FBQyxJQUFJLENBQ2YsSUFBOEIsQ0FBQyxRQUE0QyxDQUMvRSxDQUFDLEdBQUcsQ0FBQyxDQUFDLENBQUMsRUFBRSxFQUFFLENBQUMsQ0FBQyxDQUFDLFNBQVMsQ0FBQyxFQUN6QixLQUFLLENBQ1IsQ0FBQTtRQUVELE9BQU8sU0FBUztZQUNaLDJDQUEyQzthQUMxQyxNQUFNLENBQUMsT0FBTyxDQUFDO1lBQ2hCLCtDQUErQztZQUMvQyw0Q0FBNEM7YUFDM0MsR0FBRyxDQUFDLENBQUMsQ0FBQyxFQUFFLEVBQUUsQ0FBQyxDQUFDLENBQUMsT0FBTyxDQUFDLFNBQVMsRUFBRSxHQUFHLENBQUMsQ0FBQyxDQUFBO0lBQzlDLENBQUM7SUFFRDs7O09BR0c7SUFDSCxLQUFLLENBQUMsU0FBUztRQUNYLE1BQU0sSUFBSSxDQUFDLE1BQU07YUFDWixDQUFDLENBQUUsSUFBSSxDQUFDLFVBQVUsQ0FBQyxjQUFjLENBQUMsZ0JBQTZCLENBQUMsSUFBSSxDQUFDLFlBQVksQ0FBVyxDQUFDO2FBQzdGLENBQUMsQ0FBQyxJQUFJLENBQUMsVUFBVSxDQUFDLGNBQWMsQ0FBQyxTQUFtQixDQUFDO2FBQ3JELEtBQUssRUFBRSxDQUFBO0lBQ2hCLENBQUM7Q0FDSiIsInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IEVsZW1lbnRXaXRoQ29udGV4dE1lbnUgfSBmcm9tICcuLi91dGlscy5qcydcblxuLyoqXG4gKiBWaWV3IHdpdGggY2hhbm5lbCBzZWxlY3Rvci8qKlxuICpcbiAqIEBjYXRlZ29yeSBCb3R0b21CYXJcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIENoYW5uZWxWaWV3PFQ+IGV4dGVuZHMgRWxlbWVudFdpdGhDb250ZXh0TWVudTxUPiB7XG4gICAgcHJvdGVjdGVkIGFjdGlvbnNMYWJlbCE6IHN0cmluZ1xuXG4gICAgLyoqXG4gICAgKiBHZXQgbmFtZXMgb2YgYWxsIHNlbGVjdGFibGUgY2hhbm5lbHNcbiAgICAqIEByZXR1cm5zIFByb21pc2UgcmVzb2x2aW5nIHRvIGFycmF5IG9mIHN0cmluZ3MgLSBjaGFubmVsIG5hbWVzXG4gICAgKi9cbiAgICBhc3luYyBnZXRDaGFubmVsTmFtZXMgKCk6IFByb21pc2U8c3RyaW5nW10+IHtcbiAgICAgICAgLy8gc3RhYmlsaXplIHZpZXcgb3RoZXJ3aXNlIHdlIG1pZ2h0IHJ1biBpbnRvIHN0YWxlIGVsZW1lbnQgaXNzdWVzXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSB3ZGlvL25vLXBhdXNlXG4gICAgICAgIGF3YWl0IGJyb3dzZXIucGF1c2UoNTAwKVxuICAgICAgICBjb25zdCBzZWxlY3QgPSBhd2FpdCB0aGlzLnBhcmVudC4kKHRoaXMubG9jYXRvck1hcC5Cb3R0b21CYXJWaWV3cy5vdXRwdXRDaGFubmVscyBhcyBzdHJpbmcpXG4gICAgICAgIGF3YWl0IHNlbGVjdC5jbGljaygpXG5cbiAgICAgICAgLy8gc3RhYmlsaXplIHZpZXcgb3RoZXJ3aXNlIHdlIG1pZ2h0IHJ1biBpbnRvIHN0YWxlIGVsZW1lbnQgaXNzdWVzXG4gICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSB3ZGlvL25vLXBhdXNlXG4gICAgICAgIGF3YWl0IGJyb3dzZXIucGF1c2UoNTAwKVxuICAgICAgICBjb25zdCBjaGFubmVscyA9IGF3YWl0IHRoaXMucGFyZW50LiQkKGAke3RoaXMubG9jYXRvck1hcC5Cb3R0b21CYXJWaWV3cy5vdXRwdXRDaGFubmVsc30gb3B0aW9uYClcblxuICAgICAgICBjb25zdCBuYW1lcyA9IFtdXG4gICAgICAgIGZvciAoY29uc3QgY2hhbm5lbCBvZiBjaGFubmVscykge1xuICAgICAgICAgICAgbmFtZXMucHVzaChhd2FpdCBjaGFubmVsLmdldEF0dHJpYnV0ZSgndmFsdWUnKSlcbiAgICAgICAgfVxuICAgICAgICByZXR1cm4gbmFtZXNcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBHZXQgbmFtZSBvZiB0aGUgY3VycmVudCBjaGFubmVsXG4gICAgICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZpbmcgdG8gdGhlIGN1cnJlbnQgY2hhbm5lbCBuYW1lXG4gICAgICovXG4gICAgYXN5bmMgZ2V0Q3VycmVudENoYW5uZWwgKCk6IFByb21pc2U8c3RyaW5nPiB7XG4gICAgICAgIGNvbnN0IGNvbWJvID0gYXdhaXQgdGhpcy5wYXJlbnQuJCh0aGlzLmxvY2F0b3JNYXAuQm90dG9tQmFyVmlld3MuY2hhbm5lbENvbWJvIGFzIHN0cmluZylcbiAgICAgICAgcmV0dXJuIGNvbWJvLmdldFZhbHVlKClcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBTZWxlY3QgYSBjaGFubmVsIHVzaW5nIHRoZSBzZWxlY3RvciBjb21ib1xuICAgICAqIEBwYXJhbSBuYW1lIG5hbWUgb2YgdGhlIGNoYW5uZWwgdG8gb3BlblxuICAgICAqL1xuICAgIGFzeW5jIHNlbGVjdENoYW5uZWwgKG5hbWU6IHN0cmluZyk6IFByb21pc2U8dm9pZD4ge1xuICAgICAgICBjb25zdCBzZWxlY3QgPSBhd2FpdCB0aGlzLnBhcmVudC4kKHRoaXMubG9jYXRvck1hcC5Cb3R0b21CYXJWaWV3cy5vdXRwdXRDaGFubmVscyBhcyBzdHJpbmcpXG4gICAgICAgIGF3YWl0IHNlbGVjdC5jbGljaygpXG4gICAgICAgIGNvbnN0IGNoYW5uZWxzID0gYXdhaXQgdGhpcy5wYXJlbnQuJCQoYCR7dGhpcy5sb2NhdG9yTWFwLkJvdHRvbUJhclZpZXdzLm91dHB1dENoYW5uZWxzfSBvcHRpb25gKVxuICAgICAgICBmb3IgKGNvbnN0IGNoYW5uZWwgb2YgY2hhbm5lbHMpIHtcbiAgICAgICAgICAgIGNvbnN0IHZhbCA9IGF3YWl0IGNoYW5uZWwuZ2V0VmFsdWUoKVxuICAgICAgICAgICAgaWYgKHZhbCA9PT0gbmFtZSkge1xuICAgICAgICAgICAgICAgIGF3YWl0IGNoYW5uZWwuY2xpY2soKVxuICAgICAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSB3ZGlvL25vLXBhdXNlXG4gICAgICAgICAgICAgICAgYXdhaXQgYnJvd3Nlci5wYXVzZSgyMDApXG4gICAgICAgICAgICAgICAgYXdhaXQgYnJvd3Nlci5rZXlzKFsnRXNjYXBlJ10pXG4gICAgICAgICAgICAgICAgcmV0dXJuXG4gICAgICAgICAgICB9XG4gICAgICAgIH1cbiAgICAgICAgdGhyb3cgbmV3IEVycm9yKGBDaGFubmVsICR7bmFtZX0gbm90IGZvdW5kYClcbiAgICB9XG59XG5cbi8qKlxuICogVmlldyB3aXRoIGNoYW5uZWwgc2VsZWN0aW9uIGFuZCB0ZXh0IGFyZWFcbiAqL1xuZXhwb3J0IGFic3RyYWN0IGNsYXNzIFRleHRWaWV3PFQ+IGV4dGVuZHMgQ2hhbm5lbFZpZXc8VD4ge1xuICAgIHByb3RlY3RlZCBhY3Rpb25zTGFiZWwhOiBzdHJpbmdcblxuICAgIC8qKlxuICAgICAqIEdldCBhbGwgdGV4dCBmcm9tIHRoZSBjdXJyZW50bHkgb3BlbiBjaGFubmVsXG4gICAgICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZpbmcgdG8gdGhlIHZpZXcncyB0ZXh0XG4gICAgICovXG4gICAgYXN5bmMgZ2V0VGV4dCAoKTogUHJvbWlzZTxzdHJpbmdbXT4ge1xuICAgICAgICBjb25zdCBsaW5lcyA9IGF3YWl0IHRoaXMuZWxlbS4kKHRoaXMubG9jYXRvck1hcC5PdXRwdXRWaWV3LmxpbmVzIGFzIHN0cmluZylcbiAgICAgICAgY29uc3QgdGV4dExpbmVzID0gYXdhaXQgYnJvd3Nlci5leGVjdXRlKFxuICAgICAgICAgICAgKGVsZW0pID0+IEFycmF5LmZyb20oXG4gICAgICAgICAgICAgICAgKGVsZW0gYXMgYW55IGFzIEhUTUxEaXZFbGVtZW50KS5jaGlsZHJlbiBhcyBhbnkgYXMgQXJyYXlMaWtlPEhUTUxEaXZFbGVtZW50PlxuICAgICAgICAgICAgKS5tYXAoKGwpID0+IGwuaW5uZXJUZXh0KSxcbiAgICAgICAgICAgIGxpbmVzXG4gICAgICAgIClcblxuICAgICAgICByZXR1cm4gdGV4dExpbmVzXG4gICAgICAgICAgICAvLyBzdHJpcCBlbXB0eSBsaW5lcyAodXN1YWxseSB0aGUgbGFzdCBvbmUpXG4gICAgICAgICAgICAuZmlsdGVyKEJvb2xlYW4pXG4gICAgICAgICAgICAvLyByZXBsYWNlIGBcXHUwMEEwYCBjaGFyYWN0ZXJzIHdpdGggd2hpdGUgc3BhY2VcbiAgICAgICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBuby1jb250cm9sLXJlZ2V4XG4gICAgICAgICAgICAubWFwKChsKSA9PiBsLnJlcGxhY2UoL1xcdTAwQTAvZywgJyAnKSlcbiAgICB9XG5cbiAgICAvKipcbiAgICAgKiBDbGVhciB0aGUgdGV4dCBpbiB0aGUgY3VycmVudCBjaGFubmVsXG4gICAgICogQHJldHVybnMgUHJvbWlzZSByZXNvbHZpbmcgd2hlbiB0aGUgY2xlYXIgdGV4dCBidXR0b24gaXMgcHJlc3NlZFxuICAgICAqL1xuICAgIGFzeW5jIGNsZWFyVGV4dCAoKTogUHJvbWlzZTx2b2lkPiB7XG4gICAgICAgIGF3YWl0IHRoaXMucGFyZW50XG4gICAgICAgICAgICAuJCgodGhpcy5sb2NhdG9yTWFwLkJvdHRvbUJhclZpZXdzLmFjdGlvbnNDb250YWluZXIgYXMgRnVuY3Rpb24pKHRoaXMuYWN0aW9uc0xhYmVsKSBhcyBzdHJpbmcpXG4gICAgICAgICAgICAuJCh0aGlzLmxvY2F0b3JNYXAuQm90dG9tQmFyVmlld3MuY2xlYXJUZXh0IGFzIHN0cmluZylcbiAgICAgICAgICAgIC5jbGljaygpXG4gICAgfVxufVxuIl19